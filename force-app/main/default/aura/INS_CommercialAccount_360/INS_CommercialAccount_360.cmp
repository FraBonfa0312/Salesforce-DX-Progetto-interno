<!-- Developer Notes:
*Author:
*Date: August 6, 2019
*Comments: 
*Planned Revisions:
	-
*Completed Revisions:
	- Expanded data service views
	- Enabled shipping address to be referenced and displayed

-->



<aura:component implements="flexipage:availableForRecordHome,force:hasRecordId,force:hasSObjectName" access="global">
    
    <aura:attribute name="backgroundImageUrl" type="String" access="global"/>
    <aura:attribute name="backgroundHexColor" type="String" access="global"/>
    <aura:attribute name="pullMargin"	type="Boolean" access="global"/>
    <aura:attribute name="contactFields" type="String[]" access="global" default="Name,AccountLogo__c,ShippingCity, ShippingState, Prediction_Field__c,Total_Premium__c, Number_of_Employees_Location_Data__c, Number_of_Locations__c, NumberOfEmployees, Industry, Customer_Since__c, Loss_Ratio__c, Loss_Runs__c, Customer_Satisfaction_Index__c, Rate_Increase_YoY__c, Insured_Terms_yrs__c, INS_National_Rank__c, Annual_Growth__c " />
    <aura:attribute name="metric1Icon" type="String" access="global"/>
    <aura:attribute name="metric1IconSize" type="String" access="global"/>
    <aura:attribute name="metric1Label" type="String" access="global"/>
    <aura:attribute name="metric2Icon" type="String" access="global"/>
    <aura:attribute name="metric2IconSize" type="String" access="global"/>
    <aura:attribute name="metric2Label" type="String" access="global"/>
    <aura:attribute name="hideCust360Id" type="Boolean" access="global"/>
    <aura:attribute name="hideChurn" type="Boolean" access="global"/>
    <aura:attribute name="threshold1" type="Integer" access="global" default="20"/>
    <aura:attribute name="threshold2" type="Integer" access="global" default="60"/>
    <aura:attribute name="iconColor" type="String" access="global" default="#0070d2"/>

    <aura:attribute name="record" type="Object"/>
    <aura:attribute name="fields" type="Object"/>
    <aura:attribute name="recordError" type="String"/>
    
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    
    <force:recordData aura:id="recordHandler"
                      recordId="{!v.recordId}"
                      fields="{!v.contactFields}"                      
                      targetRecord="{!v.record}"
                      targetError="{!v.recordError}"
                      targetFields="{!v.fields}"
                      mode="EDIT"
      				  recordUpdated="{!c.handleRecordUpdated}"/>
    
    
    <div class="slds-card card" aura:id="card" >
    	
        <div class="header-image" style = "{! 'background-image:url(' + (v.backgroundImageUrl) + '); background-color:' + (v.backgroundHexColor) + ';'}">
        	<!-- removed to support other objects
			<div class="slds-grid slds-grid_align-end slds-p-around_medium">
              	<lightning:buttonMenu iconName="utility:down" alternativeText="More" variant="bare-inverse" menuAlignment="right" onselect="{! c.openmodal }">
                    <lightning:menuItem label="Update Card Info" value="update360" />                    
                </lightning:buttonMenu>
            </div> -->
        </div>
        
        <div class="slds-media slds-m-left_x-large">
            <div class="slds-media_figure">
                <div class="customer-image-container ">
                    <aura:if isTrue="{!empty(v.fields.AccountLogo__c)}">
                            <img src="/_slds/images/themes/lightning_lite/lightning_lite_profile_avatar_160.png" class="customer-avatar"/>
                        <aura:set attribute="else">
                            <img src="{!v.fields.AccountLogo__c}" class="customer-avatar"/>
                        </aura:set>   
                    </aura:if>
                    
                    
                    <div class="csat-indicator slds-p-right_medium">                                        
                       <aura:if isTrue="{!not(empty(v.fields.Cust360_CSAT__c))}">
                            <aura:if isTrue="{!greaterthanorequal(v.fields.Cust360_CSAT__c, 4)}">
                                <!--<img src="{!$Resource.ContactImageResources + '/ContactImageResources/Positive.png'}" alt="CSAT"  />-->
                                <lightning:icon iconName="utility:smiley_and_people" class="csat-icon csat-icon-positive" size="small"></lightning:icon>
                                <aura:set attribute="else">
                                    <aura:if isTrue="{!lessthan(v.fields.Cust360_CSAT__c, 2)}">
                                        <lightning:icon iconName="utility:sentiment_negative" class="csat-icon csat-icon-negative" size="small"></lightning:icon>
                                        <aura:set attribute="else">                                
                                                <lightning:icon iconName="utility:sentiment_neutral" class="csat-icon csat-icon-neutral" size="small"></lightning:icon>
                                        </aura:set>
                                    </aura:if>
                                </aura:set>
                            </aura:if>
                       </aura:if>     
                        
                    </div>
                </div>
        	</div>
            <div class="slds-media_body slds-m-left_medium slds-m-top_medium">
            	<div class="slds-text-heading_small title-weight">{!v.fields.Name}</div>
                <aura:if isTrue="{!not(empty(v.fields.ShippingCity))}">
                	<div class="slds-text-color_weak ">{!v.fields.ShippingCity + ', ' + v.fields.ShippingState}</div>
                </aura:if>    
            </div>
        </div>
        
		<!-- Customer Metrics -->
        <lightning:layout horizontalAlign="center" class="slds-m-vertical_medium ">
            
            <lightning:layoutItem padding="horizontal-large" size="6" flexibility="auto,grow,shrink" class="slds-border_right" >
                <div class="slds-media slds-media_center slds-media_large slds-p-left_large slds-p-right_medium" >
                    <div class="slds-media_figure slds-m-right_x-small">
                        <lightning:icon iconName="{!v.metric1Icon}" size="{!v.metric1IconSize}" class="grey-icon"/>
                    </div>
                    <div class="slds-media_body">
                        <div class=" title-weight">
                            {!v.fields.INS_National_Rank__c}
                        </div>
                        <div class="slds-text-color_weak" style="font-size:12px;">
                            {!v.metric1Label}
                        </div>
                        
                    </div>
                </div>                
                
            </lightning:layoutItem>
            
            <lightning:layoutItem padding="horizontal-large" size="6" flexibility="auto,grow,shrink" class="slds-border_left" >
                <div class="slds-media slds-media_center slds-media_large slds-p-left_medium slds-p-right_large" >
                    <div class="slds-media_figure slds-m-right_x-small">
                        <lightning:icon iconName="{!v.metric2Icon}" size="{!v.metric2IconSize}" class="grey-icon"/>
                    </div>
                    <div class="slds-media_body">
                        <div class=" title-weight">
                            <!--<ui:outputCurrency aura:id="LTV" value="{!v.fields.Cust360_Metric2__c}"/>-->
                            <ui:outputCurrency value="{!v.fields.Total_Premium__c}"/>
                        </div>
                        <div class="slds-text-color_weak" style="font-size:12px;">
                            {!v.metric2Label}
                        </div>
                        
                    </div>
                </div>                
            </lightning:layoutItem>
        </lightning:layout>
        
        <!-- Bottom Component Section -->
        
        <div class="slds-m-left_medium slds-m-right_medium slds-m-bottom_x-small slds-p-top_xx-small">
            <lightning:tabset variant="scoped" class="slds-p-around_small">
                <!-- Tab 1 -->
                <lightning:tab label="Summary" iconName="utility:multi_picklist" title="summaryDetails"
                    iconAssistiveText="Replace">
                    <div class="slds-p-horizontal_small">
                        <ul class="slds-has-dividers_bottom-space">
                            <li class="slds-item">
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col slds-size_6-of-12">
                                        <div class="slds-media slds-media_center">
                                            <div class="slds-media__figure">
                                                <lightning:icon iconName="utility:checkin" size="small"
                                                    class="grey-icon-blue" />
                                            </div>
                                            <div class="slds-media__body">
                                                <div class="slds-form-element">
                                                    <span class="slds-form-element__label">Locations:</span>
                                                    <div class="slds-form-element__control">
                                                        <span class="slds-form-element__static">{!v.fields.Number_of_Locations__c}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="slds-col slds-size_6-of-12">
                                        <div class="slds-media slds-media_center">
                                            <div class="slds-media__figure">
                                                <lightning:icon iconName="utility:location" size="small"
                                                    class="grey-icon-blue" />
                                            </div>
                                            <div class="slds-media__body">
                                                <div class="slds-form-element">
                                                    <span class="slds-form-element__label">Industry:</span>
                                                    <div class="slds-form-element__control">
                                                        <span class="slds-form-element__static">{!v.fields.Industry} </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li class="slds-item">
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col slds-size_6-of-12">
                                        <div class="slds-media slds-media_center">
                                            <div class="slds-media__figure">
                                                <lightning:icon iconName="utility:groups" size="small"
                                                    class="grey-icon-blue" />
                                            </div>
                                            <div class="slds-media__body">
                                                <div class="slds-form-element">
                                                    <span class="slds-form-element__label">Employees:</span>
                                                    <div class="slds-form-element__control">
                                                        <span class="slds-form-element__static">{!v.fields.NumberOfEmployees}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col slds-size_6-of-12">
                                        <div class="slds-media slds-media_center">
                                            <div class="slds-media__figure">
                                                <lightning:icon iconName="utility:date_input" size="small"
                                                    class="grey-icon-blue" />
                                            </div>
                                            <div class="slds-media__body">
                                                <div class="slds-form-element">
                                                    <span class="slds-form-element__label">Customer Since:</span>
                                                    <div class="slds-form-element__control">
                                                        <span
                                                            class="slds-form-element__static">{!v.fields.Customer_Since__c}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </lightning:tab>
                <!-- Tab 2 -->
                <lightning:tab label="Metrics" iconName="utility:metrics" title="keyMetrics"
                    iconAssistiveText="Replace">
                    <div class="slds-p-horizontal_small">
                        <ul class="slds-has-dividers_bottom-space">
                            <li class="slds-item">
                                <div class="slds-grid slds-grid_align-spread">
                                    <div class="slds-col slds-size_4-of-12">
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Premium Growth (YoY):</span>
                                            <div class="slds-media slds-media_center">
                                                <div class="slds-media__figure">
                                                    <!-- <lightning:dynamicIcon type="trend" option="up" alternativeText="Trending down"/> -->
                                                    <lightning:dynamicIcon type="strength" option="2" alternativeText="Strength: 2"/>
                                                </div>
                                                <div class="slds-media__body">
                                                    <span class="slds-form-element__static">
                                                        {!v.fields.Annual_Growth__c}%
                                                    </span>
                                                </div>
                                                <div class="slds-media__figure slds-media__figure_reverse"></div>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    <div class="slds-col slds-size_4-of-12">
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Loss Ratio (YoY):</span>
                                            <div class="slds-form-element__control">
                                                <span
                                                      class="slds-form-element__static ">{!v.fields.Loss_Ratio__c}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col slds-size_4-of-12">
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Customer Satisfaction:</span>
                                            <div class="slds-form-element__control">

                                                <span
                                                    class="slds-form-element__static ">{!v.fields.Customer_Satisfaction_Index__c}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li class="slds-item">
                                <div class="slds-grid slds-grid_align-spread">
                                    <div class="slds-col slds-size_4-of-12">
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Rate Increase (YoY):</span>
                                            <div class="slds-media slds-media_center">
                                                <div class="slds-media__figure">
                                                    <!-- <lightning:dynamicIcon type="trend" option="up" alternativeText="Trending down"/> -->
                                                    <lightning:dynamicIcon type="strength" option="1" alternativeText="Strength: 2"/>
                                                </div>
                                                <div class="slds-media__body">
                                                    <span class="slds-form-element__static">
                                                        {!v.fields.Rate_Increase_YoY__c}%
                                                    </span>
                                                </div>
                                                <div class="slds-media__figure slds-media__figure_reverse"></div>
                                            </div>
                                        </div>
                                        
                                        <!-- <div class="slds-form-element">
                                            <span class="slds-form-element__label">Rate Increase (YoY):</span>
                                            <div class="slds-form-element__control">
                                                <span
                                                    class="slds-form-element__static ">{!v.fields.Rate_Increase_YoY__c}%</span>
                                            </div>
                                        </div> -->
                                    </div>
                                    <div class="slds-col slds-size_4-of-12">
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Loss Runs:</span>
                                            <div class="slds-form-element__control">
                                                <span class="slds-form-element__static ">
                                                	<ui:outputCurrency value="{!v.fields.Loss_Runs__c}"/>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col slds-size_4-of-12">
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Insured Terms:</span>
                                            <div class="slds-form-element__control">
                                                <span
                                                    class="slds-form-element__static ">{!v.fields.Insured_Terms_yrs__c} yrs</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </lightning:tab>
                
                <lightning:tab label="Whitespace" iconName="utility:magicwand" title="whitespace" >
                    <div class="slds-p-top_small">
                        <!-- <c:JH_embeddedHeaderCmp Icon="standard:store_group" Title="Business Insurance" SubTitle="All products focused on commercial customers" /> -->  
                        <c:INS_agendaBuilderHeader Icon="standard:store_group" Title="Business Insurance" SubTitle="All products focused on commercial customers" />   
                        <div class="slds-p-around_x-small slds-grid slds-wrap slds-gutters">
                            <div class="slds-col slds-size_1-of-5 slds-m-bottom_small">
                                <div class="secondDiv slds-text-align_center">
                                    <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                        <img src="https://policy-icons.s3.amazonaws.com/Screen+Shot+2019-10-31+at+11.25.22+AM.png" class="iconClass2"/>
                                    </div>
                                    <div class=" textMod slds-text-color_weak" style="font-size:12px;font-weight:600;">
                                        <span>Commercial Auto
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-5">
                                <div class="secondDiv slds-text-align_center">
                                    <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                        <img src="https://policy-icons.s3.amazonaws.com/commercialProperty.png" class="iconClass2"/>
                                    </div>
                                    <div class=" textMod slds-text-color_weak" style="font-size:12px;font-weight:600;">
                                        <span>Commercial Property
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-5">
                                <div class="secondDiv slds-text-align_center" style="opacity: .3;">
                                    <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                        <img src="https://policy-icons.s3.amazonaws.com/generalLiability.png" class="iconClass2"/>
                                    </div>
                                    <div class=" textMod slds-text-color_weak" style="font-size:12px;font-weight:600;">
                                        <span>General Liability (GL)
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-5">
                                <div class="secondDiv slds-text-align_center" style="opacity: .3;">
                                    <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                        <img src="https://policy-icons.s3.amazonaws.com/businessOwnersPolicy.png" class="iconClass2"/>
                                    </div>
                                    <div class=" textMod slds-text-color_weak" style="font-size:12px;font-weight:600;">
                                        <span>Business Owners'
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-5">
                                <div class="secondDiv slds-text-align_center" style="opacity: .3;">
                                    <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                        <img src="https://policy-icons.s3.amazonaws.com/workersCompensation.png" class="iconClass2"/>
                                    </div>
                                    <div class=" textMod slds-text-color_weak" style="font-size:12px;font-weight:600;">
                                        <span>Workers' Compensation
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- <div class="slds-col slds-size_1-of-5">
                            <div class="secondDiv slds-text-align_center">
                                <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                    <img src="https://policy-icons.s3.amazonaws.com/medicalCoverage.png" class="iconClass2" style="opacity: .3;"/>
                                </div>
                                <div class=" textMod slds-text-color_weak" style="font-size:12px;">
                                    <span>Product
                                    </span>
                                </div>
                            </div>
                        </div> -->
                            
                        </div>
                        
                        <!-- <c:INS_agendaBuilderHeader Icon="standard:branch_merge" Title="Additional Insurance" SubTitle="Working on an accurate description of this" />-->
                       	<c:INS_agendaBuilderHeader Icon="standard:branch_merge" Title="Specialty Insurance" SubTitle="All non-standard, commercial focused lines of business" />   

                        <div class="slds-p-around_x-small slds-grid slds-wrap slds-gutters">
                            <div class="slds-col slds-size_1-of-5">
                                <div class="secondDiv slds-text-align_center" style="opacity: .3;">
                                    <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                        <img src="https://policy-icons.s3.amazonaws.com/professionalLiability.png" class="iconClass2"/>
                                    </div>
                                    <div class=" textMod slds-text-color_weak" style="font-size:12px;font-weight:600;">
                                        <span> Professional Liability
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-5">
                                <div class="secondDiv slds-text-align_center" style="opacity: .3;">
                                    <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                        <img src="https://policy-icons.s3.amazonaws.com/travelInsuranceIcon.png" class="iconClass2"/>
                                    </div>
                                    <div class=" textMod slds-text-color_weak" style="font-size:12px;font-weight:600;">
                                        <span> Directors and Officers
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-5">
                                <div class="secondDiv slds-text-align_center" style="opacity: .3;">
                                    <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                        <img src="https://policy-icons.s3.amazonaws.com/generalProtectionIcon.png" class="iconClass2"/>
                                    </div>
                                    <div class=" textMod slds-text-color_weak" style="font-size:12px;font-weight:600;">
                                        <span> Errors and Omissions
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-5">
                                <div class="secondDiv slds-text-align_center" style="opacity: .3;">
                                    <div class="slds-align_absolute-center slds-p-bottom_xx-small">
                                        <img src="https://policy-icons.s3.amazonaws.com/medicalCoverage.png" class="iconClass2"/>
                                    </div>
                                    <div class=" textMod slds-text-color_weak" style="font-size:12px;font-weight:600;">
                                        <span> Kidnap and Ransom
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            
                            
                            
                            
                        </div>
                    </div>
                </lightning:tab>
                
            </lightning:tabset>
        </div>
                
    </div>
    
    
    <!-- original version card based <div class="slds-col slds-size_1-of-5">
                            <div class="theBox">
                                <div class="slds-align_absolute-center slds-p-bottom_x-small slds-p-top_medium">
                                    <img src="https://state-farm-demoassets.s3.amazonaws.com/StateFarm_Condo.png" class="iconClass"/>
                                </div>
                            </div>
                        </div> -->
    
    <!-- Edit Cust 360 Modal -->
    <!-- removed to support other objects
    <div role="dialog" tabindex="-1" aria-labelledby="header43" aura:id="Modalbox" class="slds-modal">
                
        <div class="slds-modal__container">
            <div class="slds-modal__header">                
                <h2 id="header43" class="slds-text-heading_medium">Update Customer 360</h2>
            </div>
            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
               	<lightning:layout multipleRows="true" class="slds-p-bottom_x-large">
                    <lightning:layoutItem padding="around-medium" size="6">
                        <lightning:input aura:id="custCSAT" name="custCSAT" label="Customer Satisfaction" value="{!v.fields.Cust360_CSAT__c}"  />
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-medium" size="6">                        
						<lightning:select aura:id="custLoyalty" name="custLoyalty" label="Loyalty Status" value="{!v.fields.Cust360_Loyalty__c}">
                            <option value="Platinum">Platinum</option>
                            <option value="Gold">Gold</option>
                            <option value="Silver">Silver</option>
                            <option value="Bronze">Bronze</option>
                        </lightning:select>
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-medium" size="6">
                        <lightning:input aura:id="custLTV" name="custLTV" label="Lifetime Value" value="{!v.fields.Cust360_LTV__c}"  />
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="around-medium" size="6">
                        <lightning:input aura:id="custChurn" name="custChurn" label="Risk of Churn" value="{!v.fields.Cust360_ChurnRisk__c}"  />
                    </lightning:layoutItem>
                </lightning:layout>
            </div>
            <div class="slds-modal__footer">
                <lightning:button variant="neutral" label="Cancel" onclick="{!c.cancel}" />
                <lightning:button variant="brand" label="Save" onclick="{!c.handleSaveRecord}" />
            </div>
        </div> 
        
    </div>
    
    <div class="slds-backdrop " aura:id="Modalbackdrop"></div>
	-->
	
</aura:component>